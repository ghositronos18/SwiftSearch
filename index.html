<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Swift Search</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont;
  background:#0b0e14;
  color:#e8eaed;
}
.container{
  max-width:700px;
  margin:14vh auto;
  text-align:center;
}
.logo{
  font-size:2.4rem;
  font-weight:600;
  margin-bottom:22px;
}
.search{
  display:flex;
  gap:10px;
}
input{
  flex:1;
  padding:14px 16px;
  font-size:1rem;
  border-radius:24px;
  border:none;
  outline:none;
  background:#1f2937;
  color:white;
}
button{
  border:none;
  background:#2563eb;
  color:white;
  border-radius:50%;
  width:46px;
  cursor:pointer;
}
.results{
  margin-top:18px;
  text-align:left;
}
.card{
  background:#111827;
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}
.note{
  font-size:.8rem;
  color:#9ca3af;
}
</style>
</head>

<body>

<div class="container">
  <div class="logo">Swift Search</div>

  <div class="search">
    <input id="q" placeholder="Search, say a command, or ask something">
    <button id="mic">ðŸŽ¤</button>
  </div>

  <div class="results" id="results"></div>
</div>

<script>
const input = document.getElementById("q");
const results = document.getElementById("results");
const micBtn = document.getElementById("mic");

let listening = false;

/* ---------- VOICE (SIRI-LIKE) ---------- */
const SpeechRecognition =
  window.SpeechRecognition || window.webkitSpeechRecognition;

const recognizer = SpeechRecognition ? new SpeechRecognition() : null;

if (recognizer) {
  recognizer.lang = "en-US";
  recognizer.onresult = e => {
    listening = false;
    const text = e.results[0][0].transcript;
    input.value = text;
    handle(text);
  };
  recognizer.onend = () => listening = false;
}

function speak(text){
  if (listening) return;
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "en-US";
  speechSynthesis.speak(u);
}

/* ---------- SERVICE ROUTERS ---------- */
function openGoogle(q){
  window.open(`https://www.google.com/search?q=${encodeURIComponent(q)}`,"_blank");
}
function openYouTube(q){
  window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(q)}`,"_blank");
}
function openSpotify(q){
  window.open(`https://open.spotify.com/search/${encodeURIComponent(q)}`,"_blank");
}
function openMail(){
  window.open("https://mail.google.com","_blank");
}

/* ---------- INTENT ENGINE (CORE AI) ---------- */
function handle(query){
  const q = query.toLowerCase().trim();
  results.innerHTML = "";

  /* YouTube */
  if (q.startsWith("play") || q.includes("youtube")) {
    openYouTube(query);
    speak("Opening YouTube");
    return;
  }

  /* Spotify */
  if (q.includes("spotify") || q.startsWith("play song")) {
    openSpotify(query.replace("play",""));
    speak("Opening Spotify");
    return;
  }

  /* Email */
  if (q.includes("email") || q.includes("gmail")) {
    openMail();
    speak("Opening your email");
    return;
  }

  /* Open site */
  if (q.startsWith("open ")) {
    const site = q.replace("open ","").replace(" ","");
    window.open(`https://${site}.com`,"_blank");
    speak(`Opening ${site}`);
    return;
  }

  /* AI answer placeholder */
  results.innerHTML = `
    <div class="card">
      <b>AI Assistant</b>
      <p>I searched Google for this. You can refine or open links.</p>
      <div class="note">If a link is needed, it will open in a new tab.</div>
    </div>
  `;

  openGoogle(query);
}

/* ---------- EVENTS ---------- */
input.addEventListener("keydown",e=>{
  if (e.key==="Enter") handle(input.value);

  if (e.key==="/") {
    e.preventDefault();
    input.focus();
  }

  if ((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="l"){
    e.preventDefault();
    input.focus();
  }

  if (e.key==="Escape"){
    input.value="";
    input.blur();
  }
});

micBtn.onclick = () => {
  if (!recognizer) {
    alert("Voice not supported");
    return;
  }
  listening = true;
  recognizer.start();
};
</script>

</body>
</html>
